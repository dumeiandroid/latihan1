<!-- 
  File ini berfungsi untuk menghapus data dari API.
  Menampilkan konfirmasi sebelum melakukan penghapusan.
-->
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manajemen Data - Hapus Data</title>
    <!-- Memuat Tailwind CSS untuk styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gray-100 p-8 flex items-center justify-center min-h-screen">
    <div class="max-w-md mx-auto bg-white rounded-xl shadow-lg p-8 text-center">
        <div class="flex flex-col items-center mb-6">
            <div class="bg-red-500 text-white p-4 rounded-full mb-4">
                <i class="fas fa-trash-alt fa-2x"></i>
            </div>
            <h1 class="text-2xl font-bold text-red-600">Hapus Data</h1>
            <p class="text-gray-600 mt-2">Anda yakin ingin menghapus data dengan ID: <span id="dataIdDisplay" class="font-bold"></span>?</p>
        </div>
        
        <div class="flex justify-center space-x-4 mt-6">
            <a href="index_crud.html" class="bg-gray-300 text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-400 transition">Batal</a>
            <button id="deleteBtn" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition">
                <i class="fas fa-trash mr-1"></i>Hapus
            </button>
        </div>
    </div>
    
    <!-- Wadah untuk notifikasi -->
    <div id="alertContainer" class="fixed bottom-4 right-4 z-[9999]"></div>

    <script>
        // --- Konfigurasi ---
        const apiBaseUrl = 'https://lidan-co-id.pages.dev/api/contacts';
        const currentTable = 'data_latihan';
        let dataId = null;

        // --- Fungsi Pembantu (Alert) ---
        function showAlert(message, type) {
            const alertContainer = document.getElementById('alertContainer');
            const icon = type === 'success' ? 'fas fa-check-circle' : 'fas fa-times-circle';
            const bgColor = type === 'success' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800';
            
            const alertHtml = `
                <div class="flex items-center px-4 py-3 rounded-lg shadow-md mb-2 ${bgColor}">
                    <i class="${icon} mr-2"></i>
                    <span>${message}</span>
                </div>
            `;
            alertContainer.insertAdjacentHTML('beforeend', alertHtml);
            
            setTimeout(() => {
                const firstAlert = alertContainer.querySelector('div');
                if (firstAlert) {
                    firstAlert.remove();
                }
            }, 3000);
        }

        // --- Fungsi Utama ---
        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            dataId = urlParams.get('id');
            const dataIdDisplay = document.getElementById('dataIdDisplay');
            
            if (dataId) {
                dataIdDisplay.textContent = dataId;
                document.getElementById('deleteBtn').addEventListener('click', deleteData);
            } else {
                dataIdDisplay.textContent = 'Tidak Ditemukan';
                showAlert('ID data tidak ditemukan di URL.', 'danger');
            }
        });

        // Kirim permintaan hapus ke API
        async function deleteData() {
            try {
                const response = await fetch(`${apiBaseUrl}/${dataId}?table=${currentTable}`, {
                    method: 'DELETE',
                    headers: {'X-Table-Name': currentTable}
                });

                if (response.ok) {
                    showAlert('Data berhasil dihapus!', 'success');
                    // Kembali ke halaman utama setelah berhasil hapus
                    window.location.href = 'index_crud.html';
                } else {
                    showAlert('Error menghapus data!', 'danger');
                }
            } catch (error) {
                console.error('Error menghapus data:', error);
                showAlert('Error menghapus data!', 'danger');
            }
        }
    </script>
</body>
</html>
